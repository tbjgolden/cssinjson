!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((e=e||self).nCSS={})}(this,function(e){"use strict";var n,t=function(e,n){return e(n={exports:{}},n.exports),n.exports}(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.deepClone=a,n.inject=f,n.flatRulesToCSS=i,n.sourceToFlatRules=l,n.default=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return i(l(e,n,t))};var t=/\{(\^*)([0-9a-z])\}/i,r=/&/g,o=function(e,n){return typeof e===(n=n||"string")},u=function(e){return o(e[0])&&o(e[1])},c=function e(n){return function(e){return o(e[0])&&Array.isArray(e[1])&&e[1].every(u)}(n)?[n]:n.map(e).reduce(function(e,n){return e.concat(n)},[])};function a(e,n){for(var t in n=n||{},e){var r=e[t];n[t]=n[t]||(r&&o(r,"object")?a(r.constructor(),r):r)}return n}function f(e,n){var u=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(Array.isArray(e))return e.map(function(e){return f(e,n,!1)});for(var c=(e+="").match(t);c;){var a=n._.length-c[1].length-1,i=parseInt(c[2])||c[2];c=(e=e.replace(c[0],(o(i,"number")?n._[a]:n)[i])).match(t)}if(u&&n._){var l=n._[n._.length-1][0];return~e.indexOf("&")?e.replace(r,l):"".concat(l).concat(e)}return e}function i(e){return e.map(function(e){return"".concat(e[0]," { ").concat(e[1].map(function(e){return"".concat(e[0],": ").concat(e[1])}).join("; ")," }")}).join("\n")}function l(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];o(e)&&(e=JSON.parse(e));var r=[];if(Array.isArray(e)){if(o(e[0]))return f(e,n);for(var i=0;i<e.length;i++)r[i]=l(e[i],n,!1)}else if(e.$){for(var s=[],p={},d=0;d<e.$.length;d++){var v=f(e.$[d][0],n),h=a(n,{_:(n._||[]).concat([e.$[d]])}),y=l(e._,h,!1).reduce(function(e,n){return e[~~u(n)].push(n),e},[[],[]]);s.push.apply(s,y[0].reduce(function(e,n){return e.concat(n)},[])),y[1].length&&(p[v]=(p[v]||[]).concat(y[1]))}r=Object.entries(p).concat(s)}else{var _=[n];Object.keys(e).forEach(function(n){"_"!==n&&(e[n].forEach(function(e){_.map(function(t){return(t=a(t))[n]=e,t})}),_=e[n].map(function(e){return _.map(function(t){return(t=a(t))[n]=e,t})}).reduce(function(e,n){return e.concat(n)},[]))});for(var g=_.length-1;g>=0;g--)r[g]=l(e._,_[g],!1)}return t?c(r):r}}),r=(n=t)&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n,o=t.deepClone,u=t.inject,c=t.flatRulesToCSS,a=t.sourceToFlatRules;e.deepClone=o,e.default=r,e.flatRulesToCSS=c,e.inject=u,e.sourceToFlatRules=a,Object.defineProperty(e,"__esModule",{value:!0})});
