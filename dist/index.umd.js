!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).nCSS={})}(this,function(e){"use strict";const t=/\{(\^*)([0-9a-z]+)\}/i,n=/&/g;function r(e,t){return(typeof e)[0]===(t=t||"s")}function o(e){return r(e[0])&&r(e[1])}function c(e){return e.reduce((e,t)=>e.concat(t),[])}function u(e){return Array.isArray(e)?e:[e]}function f(e){const t=function(e){if(!r(e[0])||!Array.isArray(e[1]))return!1;let t=1;for(let n=0;n<e[1].length;n++)o(e[1][n])||(t=2);return t}(e);return 2===t&&(e[1]=f(e[1])),t?[e]:c(e.map(e=>f(e)))}function i(e,t){t=t||{};for(let n in e){const o=e[n];t[n]=t[n]||(o&&r(o,"o")?i(o.constructor(),o):o)}return t}function a(e,o,c){if((o=o||{})._=o._||[],c=!r(c,"b")||c,Array.isArray(e))return e.map(e=>a(e,o,!1));let u=(e+="").match(t);for(;u;){const n=o._.length-u[1].length-1,c=parseInt(u[2]),f=c==c&&n>=0?c:u[2];u=(e=e.replace(u[0],(r(f,"n")?o._[n]:o)[f])).match(t)}if(c&&o._.length){const t=o._[o._.length-1][0];return~e.indexOf("&")?e.replace(n,t):`${t}${e}`}return e}function l(e){return e.map(e=>`${e[0]} { ${e[1].map(e=>Array.isArray(e[1])?l([e]):`${e[0]}: ${e[1]}`).join("; ")} }`).join("\n")}function s(e,t,n){(t=t||{})._=t._||[],n=!r(n,"b")||n,r(e)&&(e=JSON.parse(e));let l=[];if(Array.isArray(e)){if(r(e[0]))return a(e,t);for(let n=0;n<e.length;n++)l[n]=s(e[n],t,!1)}else if(e.$){const n=[],r={};for(let f=0;f<e.$.length;f++){const l=a(e.$[f][0],t),p=i(t,{_:t._.concat([e.$[f]])}),h=s(u(e._),p,!1).reduce((e,t)=>(e[~~o(t)].push(t),e),[[],[]]);n.push.apply(n,c(h[0])),h[1].length&&(r[l]=(r[l]||[]).concat(h[1]))}l=Object.entries(r).concat(n)}else{let n=[t];Object.keys(e).forEach(t=>{"_"!==t&&(r(e[t])&&(e[t]=function(e){const t=e.split(":").map(e=>parseInt(e)).slice(0,3),n=t.length>1?t[0]:0,r=t[t.length-1],o=t.length>2?t[1]:1,c=[];let u=n;for(;n<=u&&u<r;)c.push(u),u+=o;return c}(e[t])),n=c(e[t].map(e=>n.map(n=>((n=i(n))[t]=e,n)))))});for(let t=0;t<n.length;t++)l[t]=s(u(e._),n[t],!1)}return n?f(l):l}e.deepClone=i,e.default=function(e,t,n){return l(s(e,t,n))},e.flatten=s,e.generate=l,e.inject=a,Object.defineProperty(e,"__esModule",{value:!0})});
